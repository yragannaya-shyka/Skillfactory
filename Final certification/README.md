# Проект виртуальной стажировки онлайн-школы Skillfactory
## Описание проекта
### Мобильное приложение для оправки информации туристами о посещённых ими горных перевалов.

Приложение для туристов. В горах они будут вносить данные о своем перевале в приложение и отправлять их в ФСТР ( Федерация спортивного туризма России ), как только появится доступ в Интернет, для того чтобы поделиться информацией с другими людьми, увлеющимися туризмом и преодолением горных перевалов.
## Работа проекта
### Внесение личной информации.

Для отправки информации туристу необходимо будет заполнить данные о себе (регистрация не требуется):
1. Фамилия
2. Имя
3. Отчество
4. Электронная почта
5. Номер телефона

### Внесение информации о горном перевале.

Для отправки информации о горном перевале, туристу необходимо будет также заполнить несколько полей:
1. Название горного перевала
2. Альтернативное название горного перевала
3. Произвольный текст ввиде комментария
4. Координаты горного перевала
5. Сложность восхождения (в зависимости от времени года)

### Обработка информации.

Модератор из федерации будет верифицировать и вносить в базу данных информацию, полученную от пользователей, а те в свою очередь смогут увидеть в мобильном приложении статус модерации и просматривать базу с объектами, внесёнными другими.

## Содержание проекта

### Основные пункты.

* Проект выполнен на языке программирования Python
* С использованием фреймворка Django

### Модели проекта.

Модель пользователя `MyUser` содержит 5 полей для заполнения данных о пользователе:
* 4 поля `CharField` для заполения данных
* 1 поле `EmailField` для указания электронной почты

Модель `Coords` служит для указания координат горного перевала и имеет 3 поля:
* 2 поля `DecimalField` для указания широты и долготы
* 1 поле `IntegerField` для указания высоты

Модель `Level` служит для указания уровня сложности восхождения на тот или иной горный перевал:
* Имеет 4 поля `CharField` в каждом из которых необходимо выбрать уровень сложности восхождения от 1А до 3Б

Основной моделью проекта является модель `Pereval` включающая в себя 9 полей:
* 4 поля `CharField` включающие в себя общее название, название и альтернативное название горного перевала, а таже поле `status` с выбором статуса модерации.
* 1 поле `DateTimeField` для даты добавления горного перевала
* 1 поле `TextField` для добавления произвольного комментария от пользователя
* Поля `level` и `user` имеющие отношения один ко многим с соответствующими моделями
* Поле `coords` имеющее отношение один к одному с соответствующей моделью

Модель `Images` служит для добавления фото горного перевала, имеет 3 поля:
* Поле `pereval` имеющее имеющие отношения один ко многим с соответствующей моделью
* Поле `data` имеющее тип `CharField` для добавления ссылки на изображение
* А также поле `title` для описания изображения



### Сериализаторы проекта.

Каждая модель проекта имеет соответствующий сериализатор.
Основным сериализатором проекта служит `PerevalSerializer` содержащий в себе сериализаторы остальных моделей.

```
class PerevalSerializer(WritableNestedModelSerializer):
    add_time = serializers.DateTimeField(format='%d-%m-%Y %H:%M:%S', read_only=True)
    user = MyUserSerializer()
    coords = CoordsSerializer(allow_null=True)
    level = LevelSerializer(allow_null=True)
    images = ImagesSerializer(many=True)
    
```


### Методы:

POST api/pereval/
принимает JSON в теле запроса с информацией о перевале. Пример JSON-a:



    {
    "beauty_title": "beauty_title",
    "title": "title",
    "other_titles": "other_titles",
    "connect": "connect",
    "add_time": "29-08-2024 17:34:36",
    "user": {
        "email": "test@mail.ru",
        "fam": "Иванов",
        "name": "Иван",
        "otc": "Иванов",
        "phone": "79773003030"
    },
    "coords": {
        "latitude": "10.000000",
        "longitude": "10.000000",
        "height": 157
    },
    "status": "new",
    "level": {
        "winter": "1А",
        "spring": "1А",
        "summer": "1А",
        "autumn": "1А"
    },
    "images": []
}

Результат метода: JSON

status — код HTTP, целое число: 500 — ошибка при выполнении операции; 400 — Bad Request (при нехватке полей); 200 — успех.
message — строка: Причина ошибки (если она была); Отправлено успешно; Если отправка успешна, дополнительно возвращается id вставленной записи. id — идентификатор, который был присвоен объекту при добавлении в базу данных. 

После того, как турист добавит в базу данных информацию о новом перевале, сотрудники ФСТР проведут модерацию для каждого нового объекта и поменяют поле status. Допустимые значения поля status:

        ('new', 'Новое'),
        ('pen', 'На рассмотрении'),
        ('acp', 'Принято'),
        ('rej', 'Отклонено')
        
### Метод:

GET api/pereval/<id>
получает одну запись (перевал) по её id с выведением всей информацию об перевале, в том числе статус модерации.

### Метод:

PATCH api/pereval/<id>
позволяет отредактировать существующую запись (замена), при условии что она в статусе "NW". При этом редактировать можно все поля, кроме тех, что содержат ФИО, адрес почты и номер телефона. В качестве результата изменения приходит ответ содержащий следующие данные:

state:
1 — если успешно удалось отредактировать запись в базе данных.
0 — в отредактировать запись не удалось.
message: сообщение о причине неудачного обновления записи.
### Метод:

GET api/pereval/?user_id__email=<email>
позволяет получить данные всех объектов, отправленных на сервер пользователем с почтой.

В качестве реализации использована фильтрация по адресу электронной почты пользователя с помощью пакета django-filter.   


Документация swagger: http://127.0.0.1:8000/swagger/




